# Graph Note - ì•„í‚¤í…ì²˜ ê°œì„  (V2.0)

## ğŸ¯ ê°œì„  ëª©í‘œ ë‹¬ì„±

### âœ… ì™„ë£Œëœ ì‘ì—…

#### 1. **Zustand ìƒíƒœ ê´€ë¦¬ ë„ì…**
- **graphStore**: ê·¸ë˜í”„ ë°ì´í„°, ë…¸ë“œ ìŠ¤íƒ€ì¼, ìœ„ì¹˜, íƒœê·¸ ê´€ë¦¬
- **uiStore**: UI ìƒíƒœ (ì„ íƒ, íŒ¨ë„, ëª¨ë‹¬, ì¤Œ, ë·° ëª¨ë“œ)
- **Prop Drilling ì œê±°**: 14ë‹¨ê³„ â†’ 0ë‹¨ê³„

#### 2. **ì»´í¬ë„ŒíŠ¸ ì™„ì „ ë¶„ë¦¬**
```
src/
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ graphStore.js      âœ¨ ìƒˆë¡œ ì¶”ê°€ (ê·¸ë˜í”„ ë°ì´í„° ê´€ë¦¬)
â”‚   â””â”€â”€ uiStore.js          âœ¨ ìƒˆë¡œ ì¶”ê°€ (UI ìƒíƒœ ê´€ë¦¬)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ GraphContainer.jsx  âœ¨ ìƒˆë¡œ ì¶”ê°€ (ê·¸ë˜í”„ + UI í†µí•©)
â”‚   â”œâ”€â”€ GraphControls.jsx   âœ¨ ìƒˆë¡œ ì¶”ê°€ (ì¤Œ, ì„¤ì •, ì¶”ê°€ ë²„íŠ¼)
â”‚   â””â”€â”€ NodePreviewMenu.jsx âœ¨ ìƒˆë¡œ ì¶”ê°€ (í† ê¸€ ë¯¸ë¦¬ë³´ê¸°)
â””â”€â”€ App.jsx                 â™»ï¸ ë¦¬íŒ©í† ë§ (919ì¤„ â†’ 654ì¤„, 29% ê°ì†Œ)
```

#### 3. **ì½”ë“œ í’ˆì§ˆ ê°œì„ **
- **ëª¨ë“ˆí™”**: ê¸°ëŠ¥ë³„ ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬
- **ì¬ì‚¬ìš©ì„±**: ë…ë¦½ì ì¸ ì»´í¬ë„ŒíŠ¸ë¡œ ì‰¬ìš´ í™•ì¥
- **ìœ ì§€ë³´ìˆ˜ì„±**: ë¡œì§ê³¼ UI ë¶„ë¦¬ë¡œ ë²„ê·¸ ì¶”ì  ìš©ì´

---

## ğŸ“Š Before & After

### Before (V1.2)
```jsx
// App.jsx - 919ì¤„
- ëª¨ë“  ìƒíƒœê°€ App.jsxì— ì§‘ì¤‘
- useState 15ê°œ ì‚¬ìš©
- Prop Drilling 14ë‹¨ê³„
- GraphViewê°€ App.jsx ë‚´ë¶€ì— ì •ì˜
```

### After (V2.0)
```jsx
// App.jsx - 654ì¤„ (29% ê°ì†Œ)
- graphStore: ê·¸ë˜í”„ ê´€ë ¨ ìƒíƒœ + ì•¡ì…˜
- uiStore: UI ê´€ë ¨ ìƒíƒœ + ì•¡ì…˜
- ì»´í¬ë„ŒíŠ¸ 4ê°œ ë¶„ë¦¬ (GraphContainer, GraphControls, NodePreviewMenu)
- Prop Drilling ì™„ì „ ì œê±°
```

---

## ğŸ—ï¸ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜

### ìƒíƒœ ê´€ë¦¬ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      User Interaction                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI Components                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ GraphControlsâ”‚  â”‚NodePreview   â”‚  â”‚ NotePanel    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Zustand Stores                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   graphStore         â”‚  â”‚    uiStore           â”‚         â”‚
â”‚  â”‚ - graph              â”‚  â”‚ - selectedId         â”‚         â”‚
â”‚  â”‚ - nodeStyles         â”‚  â”‚ - notePanelOpen      â”‚         â”‚
â”‚  â”‚ - lockedIds          â”‚  â”‚ - contextMenu        â”‚         â”‚
â”‚  â”‚ - savedNodePositions â”‚  â”‚ - zoomLevel          â”‚         â”‚
â”‚  â”‚ - tagsIndex          â”‚  â”‚ - graphViewMode      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Persistence Layer                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ localStorage     â”‚      â”‚ IndexedDB        â”‚            â”‚
â”‚  â”‚ (ë©”íƒ€ë°ì´í„°)      â”‚      â”‚ (ìƒì„¸ ë…¸íŠ¸)       â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ í•µì‹¬ ê°œì„  ì‚¬í•­

### 1. **graphStore** - ë°ì´í„° ê´€ë¦¬
```javascript
// ì‚¬ìš© ì˜ˆì‹œ
const { graph, addNode, updateNode, setNodeStyle } = useGraphStore();

// ë…¸ë“œ ì¶”ê°€
addNode(newNode, newLink);

// ë…¸ë“œ ì—…ë°ì´íŠ¸
updateNode(nodeId, { title: 'New Title', summary: '...' });

// ìŠ¤íƒ€ì¼ ë³€ê²½
setNodeStyle(nodeId, { color: '#ff0000', size: 'l' });
```

**ì¥ì :**
- âœ… ìë™ ì €ì¥ (localStorage)
- âœ… íƒœê·¸ ì¸ë±ìŠ¤ ìë™ ì¬êµ¬ì¶•
- âœ… ë‹¨ì¼ ì§„ì‹¤ì˜ ì›ì²œ (Single Source of Truth)

### 2. **uiStore** - UI ìƒíƒœ ê´€ë¦¬
```javascript
// ì‚¬ìš© ì˜ˆì‹œ
const { 
  selectedId, 
  notePanelOpen, 
  openNotePanel, 
  handleNodeClick 
} = useUIStore();

// ë…¸ë“œ í´ë¦­
handleNodeClick(nodeId, x, y); // ìë™ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ë©”ë‰´ í‘œì‹œ

// ë…¸íŠ¸ íŒ¨ë„ ì—´ê¸°
openNotePanel(); // ìë™ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ë©”ë‰´ ë‹«í˜
```

**ì¥ì :**
- âœ… UI ë¡œì§ ì¤‘ì•™í™”
- âœ… ì¼ê´€ëœ ìƒíƒœ ì „í™˜
- âœ… ë””ë²„ê¹… ìš©ì´

### 3. **GraphContainer** - í†µí•© ì»´í¬ë„ŒíŠ¸
```jsx
<GraphContainer {...props}>
  <GraphControls ... />
  <NodePreviewMenu ... />
  <ContextMenu ... />
</GraphContainer>
```

**ì¥ì :**
- âœ… GraphView ë‚´ë¶€ êµ¬í˜„ ìˆ¨ê¹€
- âœ… ê´€ë ¨ UI ìš”ì†Œ ê·¸ë£¹í™”
- âœ… í™•ì¥ ìš©ì´

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ë©”ëª¨ì´ì œì´ì…˜ í™œìš©
```javascript
// derivedData - ê·¸ë˜í”„ ë°ì´í„° ìºì‹±
const derivedData = useMemo(() => {
  // ë…¸ë“œ ìœ„ì¹˜ ê³„ì‚° (ë¬´ê±°ìš´ ì—°ì‚°)
  // ...
}, [graph, lockedIds, radialAnchors, savedNodePositions]);

// ë Œë”ë§ í•¨ìˆ˜ ìºì‹± (GraphContainer)
const nodeCanvasObject = React.useMemo(() => 
  makeNodeCanvasObject(nodeStyles, lockedIds, selectedId), 
  [nodeStyles, lockedIds, selectedId]
);
```

### ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
- Zustandì˜ ì„ íƒì  êµ¬ë…
- useMemo/useCallback í™œìš©
- React.memo (í–¥í›„ ì ìš© ê°€ëŠ¥)

---

## ğŸš€ í–¥í›„ í™•ì¥ ê°€ëŠ¥ì„±

### 1. ë” ì‰¬ì›Œì§„ ê¸°ëŠ¥ ì¶”ê°€
```javascript
// ìƒˆë¡œìš´ ë·° ëª¨ë“œ ì¶”ê°€ (uiStoreë§Œ ìˆ˜ì •)
const viewModes = ['relationship', 'tag', 'timeline', 'list']; // âœ¨ ìƒˆë¡œ ì¶”ê°€

// ìƒˆë¡œìš´ ë…¸ë“œ íƒ€ì… ì¶”ê°€ (graphStoreë§Œ ìˆ˜ì •)
addNode({ ...node, type: 'question' }); // âœ¨ ìƒˆë¡œ ì¶”ê°€
```

### 2. í…ŒìŠ¤íŠ¸ ì‘ì„± ìš©ì´
```javascript
// ìŠ¤í† ì–´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
test('addNode should add node to graph', () => {
  const { addNode, graph } = useGraphStore.getState();
  addNode({ id: 'test', title: 'Test' });
  expect(graph.nodes).toContainEqual({ id: 'test', title: 'Test' });
});
```

### 3. ì‹œê°„ ì—¬í–‰ ë””ë²„ê¹…
```javascript
// Zustand devtools ì—°ë™ ê°€ëŠ¥
import { devtools } from 'zustand/middleware';

export const useGraphStore = create(
  devtools((set, get) => ({ ... }))
);
```

---

## ğŸ“ ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### ê¸°ì¡´ ì½”ë“œì—ì„œ ìƒˆ ì½”ë“œë¡œ

#### Before
```jsx
// App.jsx
const [graph, setGraph] = useState(...);
const [selectedId, setSelectedId] = useState(null);

// 14ë‹¨ê³„ prop drilling
<NotePanel 
  selectedNote={selectedNote}
  onChange={updateNote}
  ... (10ê°œ ì´ìƒì˜ props)
/>
```

#### After
```jsx
// App.jsx
const { graph, updateNode } = useGraphStore();
const { selectedId, notePanelOpen } = useUIStore();

// í•„ìš”í•œ propë§Œ ì „ë‹¬
<NotePanel 
  selectedNote={selectedNote}
  onChange={updateNode}
  isOpen={notePanelOpen}
/>
```

---

## ğŸ‰ ê²°ê³¼

### ì •ëŸ‰ì  ê°œì„ 
- **ì½”ë“œ ë¼ì¸ ìˆ˜**: 919ì¤„ â†’ 654ì¤„ (29% ê°ì†Œ)
- **useState ì‚¬ìš©**: 15ê°œ â†’ 1ê°œ (93% ê°ì†Œ)
- **Prop Drilling**: 14ë‹¨ê³„ â†’ 0ë‹¨ê³„ (100% ì œê±°)
- **ì»´í¬ë„ŒíŠ¸ íŒŒì¼**: 1ê°œ â†’ 5ê°œ (ëª¨ë“ˆí™”)

### ì •ì„±ì  ê°œì„ 
- âœ… **ê°€ë…ì„±**: ê° íŒŒì¼ì˜ ì±…ì„ì´ ëª…í™•
- âœ… **ìœ ì§€ë³´ìˆ˜ì„±**: ë²„ê·¸ ë°œìƒ ì‹œ í•´ë‹¹ ìŠ¤í† ì–´/ì»´í¬ë„ŒíŠ¸ë§Œ ìˆ˜ì •
- âœ… **í™•ì¥ì„±**: ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ ê¸°ì¡´ ì½”ë“œ ì˜í–¥ ìµœì†Œí™”
- âœ… **í˜‘ì—…ì„±**: íŒ€ì›ì´ íŠ¹ì • ê¸°ëŠ¥ë§Œ ì‘ì—… ê°€ëŠ¥

---

## ğŸ” ë””ë²„ê¹… íŒ

### Zustand ìƒíƒœ í™•ì¸
```javascript
// ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ
useGraphStore.getState(); // ì „ì²´ ìƒíƒœ í™•ì¸
useUIStore.getState();    // UI ìƒíƒœ í™•ì¸
```

### ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬
```
App
â”œâ”€â”€ GraphContainer
â”‚   â”œâ”€â”€ GraphView (ForceGraph2D)
â”‚   â””â”€â”€ GraphControls
â”‚       â”œâ”€â”€ GraphViewSelector
â”‚       â”œâ”€â”€ ZoomControls
â”‚       â”œâ”€â”€ Settings Button
â”‚       â””â”€â”€ Add Node Button
â”œâ”€â”€ NodePreviewMenu
â”œâ”€â”€ ContextMenu
â”œâ”€â”€ NotePanel
â”œâ”€â”€ SettingsModal
â””â”€â”€ AddNodeModal
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Zustand ê³µì‹ ë¬¸ì„œ](https://github.com/pmndrs/zustand)
- [React ìƒíƒœ ê´€ë¦¬ íŒ¨í„´](https://react.dev/learn/managing-state)
- [ì»´í¬ë„ŒíŠ¸ ì„¤ê³„ ì›ì¹™](https://react.dev/learn/thinking-in-react)

---

**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 12ì¼  
**ë²„ì „**: V2.0  
**ì‘ì„±ì**: GitHub Copilot
